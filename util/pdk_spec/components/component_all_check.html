<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<title>gpdk.util.pdk_spec.components.component_all_check API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="../../../assets/10up-sanitize.css/11.0.1/sanitize.min.css">
<link rel="preload stylesheet" as="style" href="../../../assets/10up-sanitize.css/11.0.1/typography.min.css">
<link rel="stylesheet preload" as="style" href="../../../assets/highlight.js/10.1.1/styles/github-dark.min.css">
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}#lunr-search{width:100%;font-size:1em;padding:6px 9px 5px 9px;border:1px solid silver}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="../../../assets/highlight.js/10.1.1/highlight.min.js"></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>gpdk.util.pdk_spec.components.component_all_check</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import inspect
from collections import abc
from dataclasses import dataclass, is_dataclass, Field
from importlib import import_module
from types import ModuleType
from typing import Tuple, Set, Any, List, Union, Callable

from openpyxl import Workbook

from fnpcell import all as fp
from fnpcell.ansi.term import style, Color
from fnpcell.pdk.pcell_params import PCELL_PARAM
from fnpcell.pdk.technology import all as fpt
from ..rule import CheckRule
from ..settings import NO_NEED_CHECK_MODULES, REQUIRED_ALL_FILES, SDL_SUPPORT_PARAMETER_TYPES, ANNOTATION_TO_DEFAULT_PARAMETER_TYPES_MAP


@dataclass
class ComponentAllCheckRule(CheckRule):
    def checked(self, pdk: ModuleType, workbook: Workbook, index: int) -&gt; Tuple[str, str]:
        all_file_path = pdk.__name__ / REQUIRED_ALL_FILES
        all_file_path_str = str(all_file_path.with_suffix(&#34;&#34;).as_posix()).replace(&#34;/&#34;, &#34;.&#34;)
        title = f&#34;Checking [{all_file_path_str}]&#34;
        worksheet = workbook.active
        worksheet.cell(index, 1, f&#34;{all_file_path_str}&#34;).font = self._font
        self.title = title
        all_components_module_vals = {}
        try:
            all_components_module = import_module(all_file_path_str)
            all_components_module_vals = {v: k for k, v in inspect.getmembers(all_components_module, inspect.isclass)}
        except:
            sty = style(color=Color.RED)
            self.style = sty
            return sty, f&#34;[{all_file_path}]\nFailed to import this module(Make sure {all_file_path.name} already exists)\n\n&#34;

        abs_path = pdk.__path__[0] / REQUIRED_ALL_FILES
        all_components_paths = abs_path.parent.rglob(&#34;*.py&#34;)
        all_components_module_set: Set[Any] = set()
        all_lack_components_module: List[str] = []
        all_incorrect_parameter_types: List[str] = []
        all_sdl_not_suppert_parameter_types: List[str] = []
        call_no_arguments_failed_all_components_module: List[str] = []
        for component_path in all_components_paths:
            if component_path == abs_path:
                continue

            relative_path = pdk.__name__ / component_path.relative_to(pdk.__path__[0])
            p_str = str(relative_path.with_suffix(&#34;&#34;).as_posix()).replace(&#34;/&#34;, &#34;.&#34;)
            if p_str.find(&#34;__init__&#34;) == -1 and p_str.find(&#34;test_&#34;) == -1:
                p_module = import_module(p_str)
                clsmembers = inspect.getmembers(p_module, inspect.isclass)
                for cls_name, cls_val in clsmembers:
                    if cls_val in all_components_module_set:
                        continue
                    else:
                        all_components_module_set.add(cls_val)

                    if issubclass(cls_val, fp.PCell) and cls_name not in NO_NEED_CHECK_MODULES:
                        incorrect_parameter_types: List[str] = []
                        sdl_not_suppert_parameter_types: List[str] = []
                        cls_val_dataclass_fields = cls_val.__dataclass_fields__ if is_dataclass(cls_val) else {}
                        cls_val_fields = [i for i in cls_val.__dict__ if not i.startswith(&#34;__&#34;) and not i.endswith(&#34;__&#34;)]
                        for cls_val_name, cls_val_type in cls_val.__annotations__.items():
                            if cls_val_name in cls_val_fields:
                                cls_val_annotations_type_dict = cls_val_type.__dict__
                                cls_val_annotations_type_origin = cls_val_annotations_type_dict.get(&#34;__origin__&#34;)
                                cls_val_annotations_type_args = cls_val_annotations_type_dict.get(&#34;__args__&#34;)
                                cls_val_dataclass_field = cls_val_dataclass_fields.get(cls_val_name)

                                if cls_val_dataclass_field and hasattr(cls_val_dataclass_field, &#34;metadata&#34;):
                                    field_pcell_param = cls_val_dataclass_field.metadata.get(PCELL_PARAM)

                                    match_type = ANNOTATION_TO_DEFAULT_PARAMETER_TYPES_MAP.get(field_pcell_param.__class__)
                                    cls_val_annotations_type_args_no_none = None
                                    if (
                                        match_type
                                        and match_type != cls_val_type
                                        and cls_val_annotations_type_origin == Union
                                        and None.__class__ in cls_val_annotations_type_args
                                    ):
                                        cls_val_annotations_type_args_list = list(cls_val_annotations_type_args)
                                        cls_val_annotations_type_args_list.remove(None.__class__)
                                        if len(cls_val_annotations_type_args_list) == 1:
                                            cls_val_annotations_type_args_no_none = cls_val_annotations_type_args_list[0]

                                    if cls_val_dataclass_field and isinstance(cls_val_dataclass_field, Field):
                                        if (
                                            (match_type and not (match_type == cls_val_type or match_type == cls_val_annotations_type_args_no_none))
                                            or (isinstance(field_pcell_param, fp.MappingParam) and cls_val_annotations_type_origin != abc.Mapping)
                                            or (
                                                isinstance(field_pcell_param, fp.WaveguideTypeParam)
                                                and (inspect.isclass(cls_val_type) and not issubclass(cls_val_type, fpt.IWaveguideType))
                                            )
                                            or (
                                                isinstance(field_pcell_param, fp.DeviceParam)
                                                and (inspect.isclass(cls_val_type) and not issubclass(cls_val_type, fpt.ICellRef))
                                            )
                                        ):
                                            incorrect_parameter_types.append(
                                                f&#34;{cls_val_name} (parameter, annotation type: {cls_val_type}, default type: {field_pcell_param.__class__})&#34;
                                            )
                                        elif not isinstance(field_pcell_param, fp.Param):
                                            incorrect_parameter_types.append(
                                                f&#34;{cls_val_name} (parameter, the default parameter is not an instance of fp.param)&#34;
                                            )

                                if (
                                    cls_val_type in SDL_SUPPORT_PARAMETER_TYPES
                                    or inspect.isfunction(cls_val_type)
                                    or str(cls_val_type).find(&#34;WaveguideType&#34;) != -1
                                    or (inspect.isclass(cls_val_type) and issubclass(cls_val_type, fpt.IWaveguideType))
                                ):
                                    continue

                                elif cls_val_annotations_type_origin and cls_val_annotations_type_args:
                                    if cls_val_annotations_type_origin in (list, tuple):
                                        if all(
                                            [
                                                arg.__dict__.get(&#34;__origin__&#34;) not in (list, tuple, Union, abc.Sequence)
                                                for arg in cls_val_annotations_type_args
                                                if arg != Ellipsis
                                            ]
                                        ):
                                            continue

                                        elif len(cls_val_annotations_type_args) &gt; 0 and cls_val_annotations_type_args[0].__dict__.get(&#34;__origin__&#34;) == Union:
                                            cls_val_annotations_type_args_ = cls_val_annotations_type_args[0].__dict__.get(&#34;__args__&#34;)
                                            if all(
                                                [
                                                    arg.__dict__.get(&#34;__origin__&#34;) not in (list, tuple, Union, abc.Sequence)
                                                    for arg in cls_val_annotations_type_args_
                                                ]
                                            ):
                                                continue

                                    elif cls_val_annotations_type_origin == abc.Sequence:
                                        if all([arg.__dict__.get(&#34;__origin__&#34;) not in (list, tuple, abc.Sequence) for arg in cls_val_annotations_type_args]):
                                            continue

                                        elif len(cls_val_annotations_type_args) &gt; 0 and cls_val_annotations_type_args[0].__dict__.get(&#34;__origin__&#34;) in (
                                            tuple,
                                            Union,
                                        ):
                                            cls_val_annotations_type_args_ = cls_val_annotations_type_args[0].__dict__.get(&#34;__args__&#34;)
                                            if all(
                                                [arg.__dict__.get(&#34;__origin__&#34;) not in (list, tuple, abc.Sequence) for arg in cls_val_annotations_type_args_]
                                            ):
                                                continue

                                    elif cls_val_annotations_type_origin == abc.Mapping:
                                        continue

                                    elif inspect.isclass(cls_val_annotations_type_origin) and issubclass(cls_val_annotations_type_origin, Callable):
                                        continue

                                sdl_not_suppert_parameter_types.append(f&#34;{cls_val_name} (parameter, type: {cls_val_type})&#34;)

                        if incorrect_parameter_types:
                            incorrect_parameter_types_ = &#34;\n    &#34;.join(incorrect_parameter_types)
                            all_incorrect_parameter_types.append(f&#34;{p_str}.{cls_name}:\n    {incorrect_parameter_types_}\n&#34;)

                        if sdl_not_suppert_parameter_types:
                            sdl_not_suppert_parameter_types_ = &#34;\n    &#34;.join(sdl_not_suppert_parameter_types)
                            all_sdl_not_suppert_parameter_types.append(f&#34;{p_str}.{cls_name}:\n    {sdl_not_suppert_parameter_types_}\n&#34;)

                        if cls_val not in all_components_module_vals:
                            all_lack_components_module.append(f&#34;{p_str}.{cls_name}&#34;)

                        library = fp.Library()
                        try:
                            library += cls_val()
                        except:
                            call_no_arguments_failed_all_components_module.append(f&#34;{p_str}.{cls_name}&#34;)
                            continue

        if any(
            all_lack_components_module + call_no_arguments_failed_all_components_module + all_sdl_not_suppert_parameter_types + all_incorrect_parameter_types
        ):
            sty = style(color=Color.YELLOW)
            self.style = sty
            all_lack_components_module_ = &#34;\n  &#34;.join(all_lack_components_module)
            result_str = f&#34;[{all_file_path_str}]\n&#34;
            result_str += (
                f&#34;Found components not in {all_file_path.name}(SDL components should be reexported in {all_file_path.name}):\n  {all_lack_components_module_}\n\n&#34;
                if all_lack_components_module
                else &#34;&#34;
            )
            call_no_arguments_failed_all_components_module_ = &#34;\n  &#34;.join(call_no_arguments_failed_all_components_module)
            result_str += (
                f&#34;Found components do not provide default values to all its parameters(SDL components should provide default values to all its paramters, so users can preview them by simply calling them without arguments):\n  {call_no_arguments_failed_all_components_module_}\n\n&#34;
                if call_no_arguments_failed_all_components_module
                else &#34;&#34;
            )
            all_sdl_not_suppert_parameter_types_ = &#34;\n  &#34;.join(all_sdl_not_suppert_parameter_types)
            tip = str(SDL_SUPPORT_PARAMETER_TYPES).strip(&#34;[]&#34;)
            result_str += (
                f&#34;Found components whose parameter type is not supported by SDL(Please define parameter types according to the following types supported by SDL: {tip}):\n  {all_sdl_not_suppert_parameter_types_}\n&#34;
                if all_sdl_not_suppert_parameter_types_
                else &#34;&#34;
            )
            all_incorrect_parameter_types_ = &#34;\n  &#34;.join(all_incorrect_parameter_types)
            result_str += (
                f&#34;Found components whose annotation parameter type do not match the default parameter type(Please make sure the two parameter types match):\n  {all_incorrect_parameter_types_}\n\n&#34;
                if all_incorrect_parameter_types_
                else &#34;&#34;
            )

            return sty, result_str
        return &#34;&#34;, &#34;&#34;</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="gpdk.util.pdk_spec.components.component_all_check.ComponentAllCheckRule"><code class="flex name class">
<span>class <span class="ident">ComponentAllCheckRule</span></span>
<span>(</span><span>total: int = 0, index: int = 0)</span>
</code></dt>
<dd>
<div class="desc"><p>ComponentAllCheckRule(_font: openpyxl.styles.fonts.Font = <openpyxl.styles.fonts.Font object>
Parameters:
name=None, charset=None, family=None, b=False, i=False, strike=None, outline=None, shadow=None, condense=None, color=None, extend=None, sz=12.0, u=None, vertAlign=None, scheme=None, _style: str = '\x1b[32m', _title: str = '', total: int = 0, index: int = 0)</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ComponentAllCheckRule(CheckRule):
    def checked(self, pdk: ModuleType, workbook: Workbook, index: int) -&gt; Tuple[str, str]:
        all_file_path = pdk.__name__ / REQUIRED_ALL_FILES
        all_file_path_str = str(all_file_path.with_suffix(&#34;&#34;).as_posix()).replace(&#34;/&#34;, &#34;.&#34;)
        title = f&#34;Checking [{all_file_path_str}]&#34;
        worksheet = workbook.active
        worksheet.cell(index, 1, f&#34;{all_file_path_str}&#34;).font = self._font
        self.title = title
        all_components_module_vals = {}
        try:
            all_components_module = import_module(all_file_path_str)
            all_components_module_vals = {v: k for k, v in inspect.getmembers(all_components_module, inspect.isclass)}
        except:
            sty = style(color=Color.RED)
            self.style = sty
            return sty, f&#34;[{all_file_path}]\nFailed to import this module(Make sure {all_file_path.name} already exists)\n\n&#34;

        abs_path = pdk.__path__[0] / REQUIRED_ALL_FILES
        all_components_paths = abs_path.parent.rglob(&#34;*.py&#34;)
        all_components_module_set: Set[Any] = set()
        all_lack_components_module: List[str] = []
        all_incorrect_parameter_types: List[str] = []
        all_sdl_not_suppert_parameter_types: List[str] = []
        call_no_arguments_failed_all_components_module: List[str] = []
        for component_path in all_components_paths:
            if component_path == abs_path:
                continue

            relative_path = pdk.__name__ / component_path.relative_to(pdk.__path__[0])
            p_str = str(relative_path.with_suffix(&#34;&#34;).as_posix()).replace(&#34;/&#34;, &#34;.&#34;)
            if p_str.find(&#34;__init__&#34;) == -1 and p_str.find(&#34;test_&#34;) == -1:
                p_module = import_module(p_str)
                clsmembers = inspect.getmembers(p_module, inspect.isclass)
                for cls_name, cls_val in clsmembers:
                    if cls_val in all_components_module_set:
                        continue
                    else:
                        all_components_module_set.add(cls_val)

                    if issubclass(cls_val, fp.PCell) and cls_name not in NO_NEED_CHECK_MODULES:
                        incorrect_parameter_types: List[str] = []
                        sdl_not_suppert_parameter_types: List[str] = []
                        cls_val_dataclass_fields = cls_val.__dataclass_fields__ if is_dataclass(cls_val) else {}
                        cls_val_fields = [i for i in cls_val.__dict__ if not i.startswith(&#34;__&#34;) and not i.endswith(&#34;__&#34;)]
                        for cls_val_name, cls_val_type in cls_val.__annotations__.items():
                            if cls_val_name in cls_val_fields:
                                cls_val_annotations_type_dict = cls_val_type.__dict__
                                cls_val_annotations_type_origin = cls_val_annotations_type_dict.get(&#34;__origin__&#34;)
                                cls_val_annotations_type_args = cls_val_annotations_type_dict.get(&#34;__args__&#34;)
                                cls_val_dataclass_field = cls_val_dataclass_fields.get(cls_val_name)

                                if cls_val_dataclass_field and hasattr(cls_val_dataclass_field, &#34;metadata&#34;):
                                    field_pcell_param = cls_val_dataclass_field.metadata.get(PCELL_PARAM)

                                    match_type = ANNOTATION_TO_DEFAULT_PARAMETER_TYPES_MAP.get(field_pcell_param.__class__)
                                    cls_val_annotations_type_args_no_none = None
                                    if (
                                        match_type
                                        and match_type != cls_val_type
                                        and cls_val_annotations_type_origin == Union
                                        and None.__class__ in cls_val_annotations_type_args
                                    ):
                                        cls_val_annotations_type_args_list = list(cls_val_annotations_type_args)
                                        cls_val_annotations_type_args_list.remove(None.__class__)
                                        if len(cls_val_annotations_type_args_list) == 1:
                                            cls_val_annotations_type_args_no_none = cls_val_annotations_type_args_list[0]

                                    if cls_val_dataclass_field and isinstance(cls_val_dataclass_field, Field):
                                        if (
                                            (match_type and not (match_type == cls_val_type or match_type == cls_val_annotations_type_args_no_none))
                                            or (isinstance(field_pcell_param, fp.MappingParam) and cls_val_annotations_type_origin != abc.Mapping)
                                            or (
                                                isinstance(field_pcell_param, fp.WaveguideTypeParam)
                                                and (inspect.isclass(cls_val_type) and not issubclass(cls_val_type, fpt.IWaveguideType))
                                            )
                                            or (
                                                isinstance(field_pcell_param, fp.DeviceParam)
                                                and (inspect.isclass(cls_val_type) and not issubclass(cls_val_type, fpt.ICellRef))
                                            )
                                        ):
                                            incorrect_parameter_types.append(
                                                f&#34;{cls_val_name} (parameter, annotation type: {cls_val_type}, default type: {field_pcell_param.__class__})&#34;
                                            )
                                        elif not isinstance(field_pcell_param, fp.Param):
                                            incorrect_parameter_types.append(
                                                f&#34;{cls_val_name} (parameter, the default parameter is not an instance of fp.param)&#34;
                                            )

                                if (
                                    cls_val_type in SDL_SUPPORT_PARAMETER_TYPES
                                    or inspect.isfunction(cls_val_type)
                                    or str(cls_val_type).find(&#34;WaveguideType&#34;) != -1
                                    or (inspect.isclass(cls_val_type) and issubclass(cls_val_type, fpt.IWaveguideType))
                                ):
                                    continue

                                elif cls_val_annotations_type_origin and cls_val_annotations_type_args:
                                    if cls_val_annotations_type_origin in (list, tuple):
                                        if all(
                                            [
                                                arg.__dict__.get(&#34;__origin__&#34;) not in (list, tuple, Union, abc.Sequence)
                                                for arg in cls_val_annotations_type_args
                                                if arg != Ellipsis
                                            ]
                                        ):
                                            continue

                                        elif len(cls_val_annotations_type_args) &gt; 0 and cls_val_annotations_type_args[0].__dict__.get(&#34;__origin__&#34;) == Union:
                                            cls_val_annotations_type_args_ = cls_val_annotations_type_args[0].__dict__.get(&#34;__args__&#34;)
                                            if all(
                                                [
                                                    arg.__dict__.get(&#34;__origin__&#34;) not in (list, tuple, Union, abc.Sequence)
                                                    for arg in cls_val_annotations_type_args_
                                                ]
                                            ):
                                                continue

                                    elif cls_val_annotations_type_origin == abc.Sequence:
                                        if all([arg.__dict__.get(&#34;__origin__&#34;) not in (list, tuple, abc.Sequence) for arg in cls_val_annotations_type_args]):
                                            continue

                                        elif len(cls_val_annotations_type_args) &gt; 0 and cls_val_annotations_type_args[0].__dict__.get(&#34;__origin__&#34;) in (
                                            tuple,
                                            Union,
                                        ):
                                            cls_val_annotations_type_args_ = cls_val_annotations_type_args[0].__dict__.get(&#34;__args__&#34;)
                                            if all(
                                                [arg.__dict__.get(&#34;__origin__&#34;) not in (list, tuple, abc.Sequence) for arg in cls_val_annotations_type_args_]
                                            ):
                                                continue

                                    elif cls_val_annotations_type_origin == abc.Mapping:
                                        continue

                                    elif inspect.isclass(cls_val_annotations_type_origin) and issubclass(cls_val_annotations_type_origin, Callable):
                                        continue

                                sdl_not_suppert_parameter_types.append(f&#34;{cls_val_name} (parameter, type: {cls_val_type})&#34;)

                        if incorrect_parameter_types:
                            incorrect_parameter_types_ = &#34;\n    &#34;.join(incorrect_parameter_types)
                            all_incorrect_parameter_types.append(f&#34;{p_str}.{cls_name}:\n    {incorrect_parameter_types_}\n&#34;)

                        if sdl_not_suppert_parameter_types:
                            sdl_not_suppert_parameter_types_ = &#34;\n    &#34;.join(sdl_not_suppert_parameter_types)
                            all_sdl_not_suppert_parameter_types.append(f&#34;{p_str}.{cls_name}:\n    {sdl_not_suppert_parameter_types_}\n&#34;)

                        if cls_val not in all_components_module_vals:
                            all_lack_components_module.append(f&#34;{p_str}.{cls_name}&#34;)

                        library = fp.Library()
                        try:
                            library += cls_val()
                        except:
                            call_no_arguments_failed_all_components_module.append(f&#34;{p_str}.{cls_name}&#34;)
                            continue

        if any(
            all_lack_components_module + call_no_arguments_failed_all_components_module + all_sdl_not_suppert_parameter_types + all_incorrect_parameter_types
        ):
            sty = style(color=Color.YELLOW)
            self.style = sty
            all_lack_components_module_ = &#34;\n  &#34;.join(all_lack_components_module)
            result_str = f&#34;[{all_file_path_str}]\n&#34;
            result_str += (
                f&#34;Found components not in {all_file_path.name}(SDL components should be reexported in {all_file_path.name}):\n  {all_lack_components_module_}\n\n&#34;
                if all_lack_components_module
                else &#34;&#34;
            )
            call_no_arguments_failed_all_components_module_ = &#34;\n  &#34;.join(call_no_arguments_failed_all_components_module)
            result_str += (
                f&#34;Found components do not provide default values to all its parameters(SDL components should provide default values to all its paramters, so users can preview them by simply calling them without arguments):\n  {call_no_arguments_failed_all_components_module_}\n\n&#34;
                if call_no_arguments_failed_all_components_module
                else &#34;&#34;
            )
            all_sdl_not_suppert_parameter_types_ = &#34;\n  &#34;.join(all_sdl_not_suppert_parameter_types)
            tip = str(SDL_SUPPORT_PARAMETER_TYPES).strip(&#34;[]&#34;)
            result_str += (
                f&#34;Found components whose parameter type is not supported by SDL(Please define parameter types according to the following types supported by SDL: {tip}):\n  {all_sdl_not_suppert_parameter_types_}\n&#34;
                if all_sdl_not_suppert_parameter_types_
                else &#34;&#34;
            )
            all_incorrect_parameter_types_ = &#34;\n  &#34;.join(all_incorrect_parameter_types)
            result_str += (
                f&#34;Found components whose annotation parameter type do not match the default parameter type(Please make sure the two parameter types match):\n  {all_incorrect_parameter_types_}\n\n&#34;
                if all_incorrect_parameter_types_
                else &#34;&#34;
            )

            return sty, result_str
        return &#34;&#34;, &#34;&#34;</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="gpdk.util.pdk_spec.rule.CheckRule" href="../rule.html#gpdk.util.pdk_spec.rule.CheckRule">CheckRule</a></li>
<li><a title="gpdk.util.pdk_spec.interfaces.ICheckRule" href="../interfaces.html#gpdk.util.pdk_spec.interfaces.ICheckRule">ICheckRule</a></li>
<li>fnpcell.interfaces.IRunnable</li>
<li><a title="gpdk.util.pdk_spec.rule.Progressable" href="../rule.html#gpdk.util.pdk_spec.rule.Progressable">Progressable</a></li>
<li>fnpcell.interfaces.IUpdatable</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="gpdk.util.pdk_spec.components.component_all_check.ComponentAllCheckRule.index"><code class="name">var <span class="ident">index</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="gpdk.util.pdk_spec.components.component_all_check.ComponentAllCheckRule.total"><code class="name">var <span class="ident">total</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="gpdk.util.pdk_spec.components.component_all_check.ComponentAllCheckRule.checked"><code class="name flex">
<span>def <span class="ident">checked</span></span>(<span>self, pdk: module, workbook: openpyxl.workbook.workbook.Workbook, index: int) ‑> Tuple[str, str]</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def checked(self, pdk: ModuleType, workbook: Workbook, index: int) -&gt; Tuple[str, str]:
    all_file_path = pdk.__name__ / REQUIRED_ALL_FILES
    all_file_path_str = str(all_file_path.with_suffix(&#34;&#34;).as_posix()).replace(&#34;/&#34;, &#34;.&#34;)
    title = f&#34;Checking [{all_file_path_str}]&#34;
    worksheet = workbook.active
    worksheet.cell(index, 1, f&#34;{all_file_path_str}&#34;).font = self._font
    self.title = title
    all_components_module_vals = {}
    try:
        all_components_module = import_module(all_file_path_str)
        all_components_module_vals = {v: k for k, v in inspect.getmembers(all_components_module, inspect.isclass)}
    except:
        sty = style(color=Color.RED)
        self.style = sty
        return sty, f&#34;[{all_file_path}]\nFailed to import this module(Make sure {all_file_path.name} already exists)\n\n&#34;

    abs_path = pdk.__path__[0] / REQUIRED_ALL_FILES
    all_components_paths = abs_path.parent.rglob(&#34;*.py&#34;)
    all_components_module_set: Set[Any] = set()
    all_lack_components_module: List[str] = []
    all_incorrect_parameter_types: List[str] = []
    all_sdl_not_suppert_parameter_types: List[str] = []
    call_no_arguments_failed_all_components_module: List[str] = []
    for component_path in all_components_paths:
        if component_path == abs_path:
            continue

        relative_path = pdk.__name__ / component_path.relative_to(pdk.__path__[0])
        p_str = str(relative_path.with_suffix(&#34;&#34;).as_posix()).replace(&#34;/&#34;, &#34;.&#34;)
        if p_str.find(&#34;__init__&#34;) == -1 and p_str.find(&#34;test_&#34;) == -1:
            p_module = import_module(p_str)
            clsmembers = inspect.getmembers(p_module, inspect.isclass)
            for cls_name, cls_val in clsmembers:
                if cls_val in all_components_module_set:
                    continue
                else:
                    all_components_module_set.add(cls_val)

                if issubclass(cls_val, fp.PCell) and cls_name not in NO_NEED_CHECK_MODULES:
                    incorrect_parameter_types: List[str] = []
                    sdl_not_suppert_parameter_types: List[str] = []
                    cls_val_dataclass_fields = cls_val.__dataclass_fields__ if is_dataclass(cls_val) else {}
                    cls_val_fields = [i for i in cls_val.__dict__ if not i.startswith(&#34;__&#34;) and not i.endswith(&#34;__&#34;)]
                    for cls_val_name, cls_val_type in cls_val.__annotations__.items():
                        if cls_val_name in cls_val_fields:
                            cls_val_annotations_type_dict = cls_val_type.__dict__
                            cls_val_annotations_type_origin = cls_val_annotations_type_dict.get(&#34;__origin__&#34;)
                            cls_val_annotations_type_args = cls_val_annotations_type_dict.get(&#34;__args__&#34;)
                            cls_val_dataclass_field = cls_val_dataclass_fields.get(cls_val_name)

                            if cls_val_dataclass_field and hasattr(cls_val_dataclass_field, &#34;metadata&#34;):
                                field_pcell_param = cls_val_dataclass_field.metadata.get(PCELL_PARAM)

                                match_type = ANNOTATION_TO_DEFAULT_PARAMETER_TYPES_MAP.get(field_pcell_param.__class__)
                                cls_val_annotations_type_args_no_none = None
                                if (
                                    match_type
                                    and match_type != cls_val_type
                                    and cls_val_annotations_type_origin == Union
                                    and None.__class__ in cls_val_annotations_type_args
                                ):
                                    cls_val_annotations_type_args_list = list(cls_val_annotations_type_args)
                                    cls_val_annotations_type_args_list.remove(None.__class__)
                                    if len(cls_val_annotations_type_args_list) == 1:
                                        cls_val_annotations_type_args_no_none = cls_val_annotations_type_args_list[0]

                                if cls_val_dataclass_field and isinstance(cls_val_dataclass_field, Field):
                                    if (
                                        (match_type and not (match_type == cls_val_type or match_type == cls_val_annotations_type_args_no_none))
                                        or (isinstance(field_pcell_param, fp.MappingParam) and cls_val_annotations_type_origin != abc.Mapping)
                                        or (
                                            isinstance(field_pcell_param, fp.WaveguideTypeParam)
                                            and (inspect.isclass(cls_val_type) and not issubclass(cls_val_type, fpt.IWaveguideType))
                                        )
                                        or (
                                            isinstance(field_pcell_param, fp.DeviceParam)
                                            and (inspect.isclass(cls_val_type) and not issubclass(cls_val_type, fpt.ICellRef))
                                        )
                                    ):
                                        incorrect_parameter_types.append(
                                            f&#34;{cls_val_name} (parameter, annotation type: {cls_val_type}, default type: {field_pcell_param.__class__})&#34;
                                        )
                                    elif not isinstance(field_pcell_param, fp.Param):
                                        incorrect_parameter_types.append(
                                            f&#34;{cls_val_name} (parameter, the default parameter is not an instance of fp.param)&#34;
                                        )

                            if (
                                cls_val_type in SDL_SUPPORT_PARAMETER_TYPES
                                or inspect.isfunction(cls_val_type)
                                or str(cls_val_type).find(&#34;WaveguideType&#34;) != -1
                                or (inspect.isclass(cls_val_type) and issubclass(cls_val_type, fpt.IWaveguideType))
                            ):
                                continue

                            elif cls_val_annotations_type_origin and cls_val_annotations_type_args:
                                if cls_val_annotations_type_origin in (list, tuple):
                                    if all(
                                        [
                                            arg.__dict__.get(&#34;__origin__&#34;) not in (list, tuple, Union, abc.Sequence)
                                            for arg in cls_val_annotations_type_args
                                            if arg != Ellipsis
                                        ]
                                    ):
                                        continue

                                    elif len(cls_val_annotations_type_args) &gt; 0 and cls_val_annotations_type_args[0].__dict__.get(&#34;__origin__&#34;) == Union:
                                        cls_val_annotations_type_args_ = cls_val_annotations_type_args[0].__dict__.get(&#34;__args__&#34;)
                                        if all(
                                            [
                                                arg.__dict__.get(&#34;__origin__&#34;) not in (list, tuple, Union, abc.Sequence)
                                                for arg in cls_val_annotations_type_args_
                                            ]
                                        ):
                                            continue

                                elif cls_val_annotations_type_origin == abc.Sequence:
                                    if all([arg.__dict__.get(&#34;__origin__&#34;) not in (list, tuple, abc.Sequence) for arg in cls_val_annotations_type_args]):
                                        continue

                                    elif len(cls_val_annotations_type_args) &gt; 0 and cls_val_annotations_type_args[0].__dict__.get(&#34;__origin__&#34;) in (
                                        tuple,
                                        Union,
                                    ):
                                        cls_val_annotations_type_args_ = cls_val_annotations_type_args[0].__dict__.get(&#34;__args__&#34;)
                                        if all(
                                            [arg.__dict__.get(&#34;__origin__&#34;) not in (list, tuple, abc.Sequence) for arg in cls_val_annotations_type_args_]
                                        ):
                                            continue

                                elif cls_val_annotations_type_origin == abc.Mapping:
                                    continue

                                elif inspect.isclass(cls_val_annotations_type_origin) and issubclass(cls_val_annotations_type_origin, Callable):
                                    continue

                            sdl_not_suppert_parameter_types.append(f&#34;{cls_val_name} (parameter, type: {cls_val_type})&#34;)

                    if incorrect_parameter_types:
                        incorrect_parameter_types_ = &#34;\n    &#34;.join(incorrect_parameter_types)
                        all_incorrect_parameter_types.append(f&#34;{p_str}.{cls_name}:\n    {incorrect_parameter_types_}\n&#34;)

                    if sdl_not_suppert_parameter_types:
                        sdl_not_suppert_parameter_types_ = &#34;\n    &#34;.join(sdl_not_suppert_parameter_types)
                        all_sdl_not_suppert_parameter_types.append(f&#34;{p_str}.{cls_name}:\n    {sdl_not_suppert_parameter_types_}\n&#34;)

                    if cls_val not in all_components_module_vals:
                        all_lack_components_module.append(f&#34;{p_str}.{cls_name}&#34;)

                    library = fp.Library()
                    try:
                        library += cls_val()
                    except:
                        call_no_arguments_failed_all_components_module.append(f&#34;{p_str}.{cls_name}&#34;)
                        continue

    if any(
        all_lack_components_module + call_no_arguments_failed_all_components_module + all_sdl_not_suppert_parameter_types + all_incorrect_parameter_types
    ):
        sty = style(color=Color.YELLOW)
        self.style = sty
        all_lack_components_module_ = &#34;\n  &#34;.join(all_lack_components_module)
        result_str = f&#34;[{all_file_path_str}]\n&#34;
        result_str += (
            f&#34;Found components not in {all_file_path.name}(SDL components should be reexported in {all_file_path.name}):\n  {all_lack_components_module_}\n\n&#34;
            if all_lack_components_module
            else &#34;&#34;
        )
        call_no_arguments_failed_all_components_module_ = &#34;\n  &#34;.join(call_no_arguments_failed_all_components_module)
        result_str += (
            f&#34;Found components do not provide default values to all its parameters(SDL components should provide default values to all its paramters, so users can preview them by simply calling them without arguments):\n  {call_no_arguments_failed_all_components_module_}\n\n&#34;
            if call_no_arguments_failed_all_components_module
            else &#34;&#34;
        )
        all_sdl_not_suppert_parameter_types_ = &#34;\n  &#34;.join(all_sdl_not_suppert_parameter_types)
        tip = str(SDL_SUPPORT_PARAMETER_TYPES).strip(&#34;[]&#34;)
        result_str += (
            f&#34;Found components whose parameter type is not supported by SDL(Please define parameter types according to the following types supported by SDL: {tip}):\n  {all_sdl_not_suppert_parameter_types_}\n&#34;
            if all_sdl_not_suppert_parameter_types_
            else &#34;&#34;
        )
        all_incorrect_parameter_types_ = &#34;\n  &#34;.join(all_incorrect_parameter_types)
        result_str += (
            f&#34;Found components whose annotation parameter type do not match the default parameter type(Please make sure the two parameter types match):\n  {all_incorrect_parameter_types_}\n\n&#34;
            if all_incorrect_parameter_types_
            else &#34;&#34;
        )

        return sty, result_str
    return &#34;&#34;, &#34;&#34;</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<form>
<input id="lunr-search" name="q" placeholder="🔎 Search ..." aria-label="Search"
disabled minlength="2">
</form>
<link rel="preload stylesheet" as="style" href="../../../assets/tingle/0.15.3/tingle.min.css">
<script src="../../../assets/tingle/0.15.3/tingle.min.js"></script>
<style>
.modal-dialog iframe {
width: 100vw;
height: calc(100vh - 80px);
}
@media screen and (min-width: 700px) {
.modal-dialog iframe {
width: 70vw;
height: 80vh;
}
}
.modal-dialog .tingle-modal-box {width: auto;}
.modal-dialog .tingle-modal-box__content {padding: 0;}
</style>
<script>
const input = document.getElementById('lunr-search');
input.disabled = false;
input.form.addEventListener('submit', (ev) => {
ev.preventDefault();
const url = new URL(window.location);
url.searchParams.set('q', input.value);
history.replaceState({}, null, url.toString());
search(input.value);
});
const query = new URL(window.location).searchParams.get('q');
if (query)
search(query);
function search(query) {
const url = '../../../doc-search.html#' + encodeURIComponent(query);
new tingle.modal({
cssClass: ['modal-dialog'],
onClose: () => {
const url = new URL(window.location);
url.searchParams.delete('q');
history.replaceState({}, null, url.toString());
setTimeout(() => input.focus(), 100);
}
}).setContent('<iframe src="' + url + '"></iframe>').open();
}
</script>
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="gpdk.util.pdk_spec.components" href="index.html">gpdk.util.pdk_spec.components</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="gpdk.util.pdk_spec.components.component_all_check.ComponentAllCheckRule" href="#gpdk.util.pdk_spec.components.component_all_check.ComponentAllCheckRule">ComponentAllCheckRule</a></code></h4>
<ul class="">
<li><code><a title="gpdk.util.pdk_spec.components.component_all_check.ComponentAllCheckRule.checked" href="#gpdk.util.pdk_spec.components.component_all_check.ComponentAllCheckRule.checked">checked</a></code></li>
<li><code><a title="gpdk.util.pdk_spec.components.component_all_check.ComponentAllCheckRule.index" href="#gpdk.util.pdk_spec.components.component_all_check.ComponentAllCheckRule.index">index</a></code></li>
<li><code><a title="gpdk.util.pdk_spec.components.component_all_check.ComponentAllCheckRule.total" href="#gpdk.util.pdk_spec.components.component_all_check.ComponentAllCheckRule.total">total</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
</footer>
</body>
</html>